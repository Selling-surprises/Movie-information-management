<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>番剧历史记录索引管理系统</title>
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <link rel="stylesheet" href="css/all.min.css">
    <!-- 改为CDN引用Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7eb 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            transition: background 0.5s, color 0.5s;
        }
        
        .dark-theme {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
        }
        
        .dark-theme header {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .dark-theme .upload-section,
        .dark-theme .table-container,
        .dark-theme .detail-section,
        .dark-theme footer,
        .dark-theme .stat-item,
        .dark-theme .edit-form,
        .dark-theme .confirmation-dialog .dialog-content,
        .dark-theme .file-info {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(76, 201, 240, 0.2);
            color: #e6e6e6;
        }
        
        .dark-theme .upload-area {
            background: rgba(26, 32, 44, 0.5);
            border: 2px dashed #4cc9f0;
        }
        
        .dark-theme .upload-area:hover {
            background: rgba(26, 32, 44, 0.7);
        }
        
        .dark-theme .upload-area h3 {
            color: #4cc9f0;
        }
        
        .dark-theme .data-table th {
            background: rgba(76, 201, 240, 0.15);
            color: #4cc9f0;
        }
        
        .dark-theme .data-table td {
            background: rgba(26, 32, 44, 0.3);
        }
        
        .dark-theme .search-box input {
            background: rgba(26, 32, 44, 0.8);
            color: #e2e8f0;
            border: 1px solid #2d3748;
        }
        
        .dark-theme .filter-btn {
            background: rgba(26, 32, 44, 0.8);
            border: 1px solid #2d3748;
            color: #a0aec0;
        }
        
        .dark-theme .filter-btn:hover, 
        .dark-theme .filter-btn.active {
            background: #4cc9f0;
            color: #1a202c;
        }
        
        .dark-theme .detail-info p {
            color: #a0aec0;
        }
        
        .dark-theme .detail-info span,
        .dark-theme .detail-content p {
            color: #e2e8f0 !important;
        }
        
        .dark-theme .stat-label {
            color: #a0aec0;
        }
        
        .dark-theme .notification {
            background: rgba(46, 204, 113, 0.95);
            color: white;
        }
        
        .dark-theme .theme-toggle {
            background: rgba(26, 32, 44, 0.8);
            color: #4cc9f0;
            border: 1px solid #4cc9f0;
        }
        
        .dark-theme .theme-toggle:hover {
            background: #4cc9f0;
            color: white;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
            position: relative;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            margin-top: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(108, 122, 137, 0.2);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #4cc9f0, #4361ee, #9b59b6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 1px;
            text-shadow: 0 2px 10px rgba(76, 201, 240, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #6c757d;
            margin-bottom: 20px;
        }
        
        .main-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 1100px) {
            .main-content {
                flex-direction: column;
            }
        }
        
        .upload-section {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            flex: 1;
            border: 1px solid rgba(108, 122, 137, 0.2);
            backdrop-filter: blur(5px);
        }
        
        .table-container {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            flex: 2;
            max-height: 75vh;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            border: 1px solid rgba(108, 122, 137, 0.2);
            backdrop-filter: blur(5px);
        }
        
        .controls {
            padding: 20px;
            background: rgba(255, 255, 255, 0.85);
            border-bottom: 1px solid rgba(108, 122, 137, 0.2);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .dark-theme .controls {
            background: rgba(23, 25, 35, 0.8);
        }
        
        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border-radius: 50px;
            border: 1px solid #bdc3c7;
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            font-size: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .search-box input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(76, 201, 240, 0.3);
            border-color: #4cc9f0;
        }
        
        .search-box i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: #4cc9f0;
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #bdc3c7;
            color: #2c3e50;
            padding: 8px 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: #4cc9f0;
            color: #fff;
            border-color: #4cc9f0;
            box-shadow: 0 0 15px rgba(76, 201, 240, 0.4);
        }
        
        /* ========== 修改：添加表格横向滚动支持 ========== */
        .data-table-wrapper {
            flex: 1;
            overflow-x: auto;
            overflow-y: auto;
            position: relative;
        }
        
        .data-table {
            width: 100%;
            min-width: 800px; /* 确保表格有最小宽度，在小屏幕时出现横向滚动 */
            border-collapse: collapse;
            overflow-y: auto;
        }
        
        .data-table th {
            background: rgba(76, 201, 240, 0.1);
            padding: 16px 15px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            position: sticky;
            top: 0;
            backdrop-filter: blur(5px);
            border-bottom: 2px solid rgba(76, 201, 240, 0.2);
            white-space: nowrap;
        }
        
        .data-table td {
            padding: 14px 15px;
            border-bottom: 1px solid rgba(76, 201, 240, 0.1);
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.6);
            white-space: nowrap;
        }
        
        .data-table tr {
            transition: all 0.3s ease;
        }
        
        .data-table tr:hover {
            background: rgba(76, 201, 240, 0.1);
        }
        
        .data-table tr.selected-row {
            background: rgba(76, 201, 240, 0.25) !important;
            box-shadow: inset 0 0 0 2px #4cc9f0, 0 5px 15px rgba(76, 201, 240, 0.2);
            transform: scale(1.005);
            position: relative;
            z-index: 1;
        }
        
        .data-table tr.selected-row.type-normal {
            background: rgba(46, 204, 113, 0.25) !important;
            box-shadow: inset 0 0 0 2px #2ecc71, 0 5px 15px rgba(46, 204, 113, 0.2);
        }
        
        .data-table tr.selected-row.type-hentai {
            background: rgba(231, 76, 60, 0.25) !important;
            box-shadow: inset 0 0 0 2px #e74c3c, 0 5px 15px rgba(231, 76, 60, 0.2);
        }
        
        .data-table tr.selected-row.type-short {
            background: rgba(155, 89, 182, 0.25) !important;
            box-shadow: inset 0 0 0 2px #9b59b6, 0 5px 15px rgba(155, 89, 182, 0.2);
        }
        
        .type-tag {
            padding: 4px 10px;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
            display: inline-block;
        }
        
        .type-normal {
            background: rgba(46, 204, 113, 0.15);
            color: #2ecc71;
        }
        
        .type-hentai {
            background: rgba(231, 76, 60, 0.15);
            color: #e74c3c;
        }
        
        .type-short {
            background: rgba(155, 89, 182, 0.15);
            color: #9b59b6;
        }
        
        .content-mod {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .uncensored {
            background: rgba(46, 204, 113, 0.15);
            color: #2ecc71;
        }
        
        .censored {
            background: rgba(231, 76, 60, 0.15);
            color: #e74c3c;
        }
        
        .thumbnail {
            width: 80px;
            height: 60px;
            border-radius: 5px;
            object-fit: cover;
            background: linear-gradient(45deg, #4cc9f0, #4361ee);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
            text-align: center;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .thumbnail:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(76, 201, 240, 0.4);
        }
        
        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .detail-section {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 300px;
            flex: 1;
            border: 1px solid rgba(108, 122, 137, 0.2);
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        
        .detail-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .detail-img {
            width: 250px;
            height: 150px;
            border-radius: 10px;
            background: linear-gradient(45deg, #4cc9f0, #4361ee);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            flex-shrink: 0;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .detail-img:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        
        .detail-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .detail-info h2 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #4cc9f0;
        }
        
        .detail-info p {
            margin-bottom: 8px;
            color: #555;
        }
        
        .detail-info span {
            color: #333;
            font-weight: 500;
        }
        
        .upload-area {
            border: 2px dashed #4361ee;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 25px;
            background: rgba(245, 247, 250, 0.7);
        }
        
        .upload-area:hover {
            background: rgba(230, 233, 238, 0.8);
            border-color: #4361ee;
            box-shadow: 0 0 20px rgba(76, 201, 240, 0.3);
        }
        
        .upload-area i {
            font-size: 3.5rem;
            color: #4361ee;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover i {
            color: #4361ee;
            transform: scale(1.1);
        }
        
        .upload-area h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #4361ee;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover h3 {
            color: #4361ee;
        }
        
        .upload-area p {
            color: #6c757d;
            margin-bottom: 20px;
        }
        
        .upload-btn {
            background: linear-gradient(45deg, #4cc9f0, #4361ee);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.3);
            position: relative;
            overflow: hidden;
            display: inline-block;
        }
        
        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(76, 201, 240, 0.4);
            background: linear-gradient(45deg, #4361ee, #4cc9f0);
        }
        
        .upload-btn:after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        
        .upload-btn:hover:after {
            transform: rotate(45deg) translate(100%, 0);
        }
        
        .file-info {
            background: rgba(245, 247, 250, 0.7);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(108, 122, 137, 0.2);
        }
        
        .file-info h4 {
            color: #4cc9f0;
            margin-bottom: 10px;
        }
        
        .file-info p {
            color: #6c757d;
            line-height: 1.6;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #6c757d;
            font-size: 0.9rem;
            border-top: 1px solid rgba(108, 122, 137, 0.2);
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            backdrop-filter: blur(5px);
        }
        
        .stats {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.85);
            padding: 15px 25px;
            border-radius: 10px;
            min-width: 150px;
            border: 1px solid rgba(108, 122, 137, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .stat-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(76, 201, 240, 0.2);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4cc9f0;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #555;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.85);
            gap: 10px;
            position: sticky;
            bottom: 0;
            align-items: center;
            flex-wrap: wrap;
            border-top: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .dark-theme .pagination {
            background: rgba(23, 25, 35, 0.8);
        }
        
        .page-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(76, 201, 240, 0.1);
            border: 1px solid #bdc3c7;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .page-btn:hover, .page-btn.active {
            background: #4cc9f0;
            color: #fff;
            border-color: #4cc9f0;
            box-shadow: 0 0 10px rgba(76, 201, 240, 0.4);
        }
        
        .page-input {
            width: 50px;
            height: 40px;
            padding: 5px;
            text-align: center;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            font-size: 1rem;
        }
        
        .page-input:focus {
            outline: none;
            border-color: #4cc9f0;
            box-shadow: 0 0 0 2px rgba(76, 201, 240, 0.3);
        }
        
        .page-text {
            margin: 0 10px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .detail-header {
                flex-direction: column;
                text-align: center;
            }
            
            .pagination {
                flex-wrap: wrap;
            }
            
            /* 移动端表格横向滚动优化 */
            .data-table-wrapper {
                overflow-x: scroll;
                -webkit-overflow-scrolling: touch;
            }
            
            .data-table {
                min-width: 900px; /* 移动端保持最小宽度确保滚动 */
            }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            background: rgba(46, 204, 113, 0.95);
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            transform: translateX(120%);
            transition: transform 0.4s ease;
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: rgba(231, 76, 60, 0.9);
        }
        
        .notification.warning {
            background: rgba(241, 196, 15, 0.9);
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }
        
        .empty-state i {
            font-size: 5rem;
            margin-bottom: 20px;
            color: #4cc9f0;
            opacity: 0.6;
        }
        
        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #333;
        }
        
        .empty-state p {
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }
        
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        .delay-5 { animation-delay: 0.5s; }
        
        /* 编辑模式样式 */
        .edit-mode {
            background: rgba(76, 201, 240, 0.05);
        }
        
        .edit-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            padding: 10px;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid rgba(108, 122, 137, 0.2);
        }
        
        .edit-form input, .edit-form select {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            background: rgba(255, 255, 255, 0.8);
            color: #333;
        }
        
        .edit-form input:focus, .edit-form select:focus {
            outline: none;
            border-color: #4cc9f0;
            box-shadow: 0 0 0 2px rgba(76, 201, 240, 0.3);
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 150px;
        }
        
        .form-group label {
            font-size: 0.85rem;
            margin-bottom: 5px;
            color: #6c757d;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            width: 100%;
            justify-content: flex-end;
        }
        
        .action-btn {
            padding: 8px 15px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .save-btn {
            background: linear-gradient(45deg, #4cc9f0, #4361ee);
            color: white;
        }
        
        .cancel-btn {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        
        .save-btn:hover {
            background: linear-gradient(45deg, #4361ee, #4cc9f0);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(76, 201, 240, 0.3);
        }
        
        .cancel-btn:hover {
            background: rgba(231, 76, 60, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(231, 76, 60, 0.2);
        }
        
        /* 导出按钮样式 */
        .export-btn {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.2);
            margin-top: 15px;
            width: 100%;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(155, 89, 182, 0.3);
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
        }
        
        .export-btn:after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        
        .export-btn:hover:after {
            transform: rotate(45deg) translate(100%, 0);
        }
        
        /* 清空按钮样式 */
        .clear-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.2);
            margin-top: 15px;
            width: 100%;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .clear-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.3);
            background: linear-gradient(45deg, #c0392b, #e74c3c);
        }
        
        .clear-btn:after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        
        .clear-btn:hover:after {
            transform: rotate(45deg) translate(100%, 0);
        }
        
        /* 操作按钮优化 */
        .edit-btn, .delete-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            font-size: 14px;
        }
        
        .edit-btn {
            background: #3498db;
            margin-right: 8px;
        }
        
        .edit-btn:hover {
            background: #2980b9;
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.4);
        }
        
        .delete-btn {
            background: #e74c3c;
        }
        
        .delete-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(231, 76, 60, 0.4);
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        /* 导出进度 */
        .export-progress {
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 10px;
            display: none;
        }
        
        .export-progress-bar {
            height: 100%;
            background: white;
            width: 0%;
            transition: width 0.3s;
        }
        
        .exporting .export-progress {
            display: block;
        }
        
        .exporting .export-btn {
            pointer-events: none;
            opacity: 0.8;
        }
        
        /* 确认对话框 */
        .confirmation-dialog {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .confirmation-dialog.show {
            opacity: 1;
            visibility: visible;
        }
        
        .dialog-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(-20px);
            transition: transform 0.3s;
            border: 1px solid rgba(108, 122, 137, 0.3);
        }
        
        .confirmation-dialog.show .dialog-content {
            transform: translateY(0);
        }
        
        .dialog-header {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .dialog-header h3 {
            font-size: 1.5rem;
            color: #e74c3c;
        }
        
        .dialog-body {
            margin-bottom: 25px;
            line-height: 1.6;
            color: #6c757d;
        }
        
        .dialog-footer {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }
        
        .dialog-btn {
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
        }
        
        .dialog-cancel {
            background: rgba(44, 82, 130, 0.3);
            color: #6c757d;
            border: 1px solid #bdc3c7;
        }
        
        .dialog-confirm {
            background: #e74c3c;
            color: white;
        }
        
        .dialog-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .dialog-cancel:hover {
            background: rgba(44, 82, 130, 0.5);
        }
        
        .dialog-confirm:hover {
            background: #c0392b;
        }
        
        /* 新添加的选中状态指示器 */
        .selected-indicator {
            position: absolute;
            left: -15px;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            background: #4cc9f0;
            border-radius: 50%;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .selected-row .selected-indicator {
            opacity: 1;
            width: 12px;
            height: 12px;
        }
        
        .selected-row.type-normal .selected-indicator {
            background: #2ecc71;
        }
        
        .selected-row.type-hentai .selected-indicator {
            background: #e74c3c;
        }
        
        .selected-row.type-short .selected-indicator {
            background: #9b59b6;
        }
        
        /* 添加炫酷的动画 */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 201, 240, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(76, 201, 240, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 201, 240, 0); }
        }
        
        .selected-row {
            animation: pulse 1.5s ease-in-out;
        }
        
        /* 主题切换按钮 */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #f5f7fa;
            border: 1px solid #4cc9f0;
            color: #4cc9f0;
            padding: 8px 15px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 10;
        }
        
        .theme-toggle:hover {
            background: #4cc9f0;
            color: white;
            box-shadow: 0 0 10px rgba(76, 201, 240, 0.4);
        }
        
        /* 筛选组样式 */
        .filter-group {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .filter-group-title {
            color: #4cc9f0;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        /* 加载动画 */
        .loader {
            display: flex;
            justify-content: center;
            padding: 20px;
            color: #4cc9f0;
        }
        
        .loader-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(76, 201, 240, 0.3);
            border-radius: 50%;
            border-top: 4px solid #4cc9f0;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            to { transform: rotate(1turn); }
        }
        
        /* 修复暗色主题下的加载动画颜色 */
        .dark-theme .loader-spinner {
            border: 4px solid rgba(76, 201, 240, 0.3);
            border-top: 4px solid #4cc9f0;
        }
        
        /* 图片上传相关样式 */
        .image-upload-container {
            margin-top: 10px;
            border: 1px dashed #4cc9f0;
            border-radius: 8px;
            padding: 10px;
            background: rgba(245, 247, 250, 0.7);
        }
        
        .image-upload-btn {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .image-upload-btn:hover {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 150px;
            margin-top: 10px;
            border-radius: 5px;
            display: none;
        }
        
        .remove-image-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
        }
        
        .remove-image-btn:hover {
            background: #c0392b;
        }
        
        .upload-status {
            margin-top: 5px;
            font-size: 0.8rem;
            color: #4cc9f0;
        }
        
        /* ========== 修改：下载提示样式（改为居中弹出） ========== */
        .download-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 90%;
            max-width: 400px;
            padding: 25px;
            border-radius: 15px;
            background: rgba(76, 201, 240, 0.95);
            color: white;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            gap: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-align: left;
            opacity: 0;
            visibility: hidden;
        }
        
        .download-notification.show {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            visibility: visible;
        }
        
        .download-notification i {
            font-size: 2.2rem;
            color: white;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.2);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .download-notification-content {
            flex: 1;
        }
        
        .download-notification-title {
            font-weight: 700;
            font-size: 1.3rem;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }
        
        .download-notification-message {
            font-size: 0.95rem;
            line-height: 1.5;
            opacity: 0.9;
        }
        
        .close-download-notification {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.3s;
            position: absolute;
            top: 15px;
            right: 15px;
        }
        
        .close-download-notification:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        
        .download-notification strong {
            font-weight: 700;
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            margin: 0 2px;
        }
        
        /* 暗色主题适配 */
        .dark-theme .download-notification {
            background: rgba(30, 41, 59, 0.98);
            border: 1px solid rgba(76, 201, 240, 0.4);
            color: #e6e6e6;
        }
        
        /* ========== 移动端优化样式 ========== */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                padding-bottom: 80px; /* 为底部导航栏留出空间 */
            }
            
            .container {
                width: 100%;
            }
            
            header {
                padding: 20px 15px;
                margin-bottom: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
                padding-right: 10px;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            /* 移动端隐藏标题旁边的主题切换按钮 */
            .theme-toggle {
                display: none;
            }
            
            .main-content {
                flex-direction: column;
                gap: 15px;
            }
            
            /* 隐藏电脑端的上传区域 */
            .upload-section {
                display: none;
            }
            
            /* 移动端表格容器 */
            .table-container {
                max-height: 60vh;
                border-radius: 10px;
                margin-bottom: 15px;
            }
            
            /* 移动端详情区域 */
            .detail-section {
                padding: 20px;
                min-height: auto;
                margin-bottom: 15px;
            }
            
            .detail-img {
                width: 100%;
                max-width: 250px;
                height: 120px;
                margin: 0 auto;
            }
            
            .detail-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .detail-info h2 {
                font-size: 1.5rem;
            }
            
            /* 移动端统计区域 */
            .stats {
                gap: 10px;
                margin-top: 10px;
            }
            
            .stat-item {
                min-width: calc(50% - 10px);
                padding: 12px 15px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            /* 移动端分页 - 确保显示并优化图标 */
            .pagination {
                display: flex !important; /* 强制显示 */
                padding: 10px;
                position: relative;
                background: rgba(255, 255, 255, 0.85);
                border-top: 1px solid rgba(76, 201, 240, 0.2);
                min-height: 60px;
            }
            
            .dark-theme .pagination {
                background: rgba(23, 25, 35, 0.8);
            }
            
            .page-btn, .page-input {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }
            
            .page-text {
                font-size: 0.8rem;
                margin: 0 5px;
                color: #6c757d;
            }
            
            /* 确保分页按钮图标正确显示 */
            .page-btn i {
                font-size: 14px !important;
                display: inline-block !important;
            }
            
            /* 移动端表格适配 */
            .data-table th, 
            .data-table td {
                padding: 10px 8px;
                font-size: 0.9rem;
            }
            
            .thumbnail {
                width: 60px;
                height: 45px;
            }
            
            .type-tag, .content-mod {
                font-size: 0.75rem;
                padding: 3px 8px;
            }
            
            .edit-btn, .delete-btn {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
            
            /* 移动端编辑表单 */
            .edit-form {
                flex-direction: column;
                gap: 10px;
            }
            
            .form-group {
                min-width: 100%;
            }
            
            /* 移动端通知 */
            .notification {
                top: 10px;
                right: 10px;
                left: 10px;
                transform: translateY(-150%);
            }
            
            .notification.show {
                transform: translateY(0);
            }
            
            /* 移动端下载提示样式调整 */
            .download-notification {
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0.9);
                width: calc(100% - 40px);
                max-width: 350px;
                padding: 20px;
                border-radius: 12px;
                backdrop-filter: blur(20px);
            }
            
            .download-notification.show {
                transform: translate(-50%, -50%) scale(1);
            }
            
            .download-notification i {
                font-size: 1.8rem;
                width: 50px;
                height: 50px;
            }
            
            .download-notification-title {
                font-size: 1.1rem;
            }
            
            .download-notification-message {
                font-size: 0.9rem;
            }
            
            .close-download-notification {
                width: 35px;
                height: 35px;
                top: 10px;
                right: 10px;
            }
            
            /* 隐藏电脑端的筛选按钮和搜索框 */
            .controls {
                display: none;
            }
            
            /* 确保Font Awesome图标正确显示 */
            .fas, .fab, .far, .fal {
                font-family: "Font Awesome 5 Free" !important;
                font-weight: 900 !important;
            }
            
            .fab {
                font-family: "Font Awesome 5 Brands" !important;
            }
            
            /* 移动端操作按钮图标 */
            .edit-btn i, .delete-btn i, 
            .action-btn i, .image-upload-btn i,
            .remove-image-btn i {
                font-size: inherit !important;
            }
        }
        
        /* ========== 移动端右侧边栏 ========== */
        .mobile-sidebar {
            position: fixed;
            top: 0;
            right: -320px;
            width: 300px;
            height: 100%;
            background: rgba(255, 255, 255, 0.97);
            backdrop-filter: blur(15px);
            z-index: 10000;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: -5px 0 30px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border-left: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .dark-theme .mobile-sidebar {
            background: rgba(30, 41, 59, 0.97);
            color: #e6e6e6;
            border-left: 1px solid rgba(76, 201, 240, 0.3);
        }
        
        .mobile-sidebar.open {
            right: 0;
        }
        
        .sidebar-header {
            padding: 20px;
            background: linear-gradient(45deg, #4cc9f0, #4361ee);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .sidebar-header h3 {
            font-size: 1.3rem;
        }
        
        .close-sidebar {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .close-sidebar:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 0 80px 0;
        }
        
        .sidebar-section {
            padding: 20px;
            border-bottom: 1px solid rgba(76, 201, 240, 0.15);
        }
        
        .sidebar-section:last-child {
            border-bottom: none;
        }
        
        .sidebar-section h4 {
            margin-bottom: 15px;
            color: #4cc9f0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .sidebar-section h4 i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        /* 修复移动端搜索框图标位置问题 */
        .sidebar-search-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        .sidebar-search {
            width: 100%;
            padding: 12px 15px 12px 40px;
            border-radius: 25px;
            border: 1px solid #bdc3c7;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 1rem;
        }
        
        .sidebar-search:focus {
            outline: none;
            border-color: #4cc9f0;
            box-shadow: 0 0 0 2px rgba(76, 201, 240, 0.3);
        }
        
        .sidebar-search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #4cc9f0;
            z-index: 2;
            font-size: 1rem;
        }
        
        .sidebar-filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .sidebar-filter-btn {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #bdc3c7;
            border-radius: 8px;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            flex: 1;
            min-width: calc(50% - 8px);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .sidebar-filter-btn.active {
            background: #4cc9f0;
            color: white;
            border-color: #4cc9f0;
            box-shadow: 0 3px 10px rgba(76, 201, 240, 0.3);
        }
        
        .sidebar-btn {
            width: 100%;
            padding: 14px 20px;
            margin-bottom: 12px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(45deg, #4cc9f0, #4361ee);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            box-shadow: 0 4px 10px rgba(76, 201, 240, 0.2);
        }
        
        .sidebar-btn i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        .sidebar-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(76, 201, 240, 0.4);
        }
        
        .sidebar-btn:active {
            transform: translateY(-1px);
        }
        
        .sidebar-btn.theme {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
        }
        
        .sidebar-btn.upload {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }
        
        .sidebar-btn.export {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
        }
        
        .sidebar-btn.clear {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .sidebar-btn-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .sidebar-btn-group .sidebar-btn {
            flex: 1;
            justify-content: center;
            text-align: center;
            padding: 12px 10px;
        }
        
        /* 移动端底部导航栏 */
        .mobile-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-top: 1px solid rgba(76, 201, 240, 0.3);
            display: flex;
            z-index: 9999;
            box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.15);
            height: 70px;
        }
        
        .dark-theme .mobile-nav {
            background: rgba(30, 41, 59, 0.98);
        }
        
        .mobile-nav-btn {
            flex: 1;
            padding: 12px 5px;
            border: none;
            background: none;
            color: #6c757d;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.75rem;
            position: relative;
        }
        
        .mobile-nav-btn.active {
            color: #4cc9f0;
        }
        
        .mobile-nav-btn.active:after {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 3px;
            background: #4cc9f0;
            border-radius: 0 0 3px 3px;
        }
        
        .mobile-nav-btn i {
            font-size: 1.4rem;
            transition: all 0.3s;
        }
        
        .mobile-nav-btn.active i {
            transform: scale(1.1);
        }
        
        /* 侧边栏遮罩 */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .sidebar-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        /* 暗色主题适配 */
        .dark-theme .sidebar-search {
            background: rgba(26, 32, 44, 0.9);
            color: #e2e8f0;
            border-color: #2d3748;
        }
        
        .dark-theme .sidebar-filter-btn {
            background: rgba(26, 32, 44, 0.9);
            color: #a0aec0;
            border-color: #2d3748;
        }
        
        .dark-theme .sidebar-filter-btn.active {
            background: #4cc9f0;
            color: #1a202c;
        }
        
        /* 电脑端隐藏移动端元素 */
        @media (min-width: 769px) {
            .mobile-sidebar,
            .mobile-nav,
            .sidebar-overlay {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- 修改：移动端下载提示（改为居中弹出） -->
    <div class="download-notification" id="downloadNotification">
        <i class="fas fa-download"></i>
        <div class="download-notification-content">
            <div class="download-notification-title">文件下载中</div>
            <div class="download-notification-message">
                文件已开始下载，默认保存到您的<strong>下载目录(Downloads)</strong>。如果下载未开始，请检查浏览器设置。
            </div>
        </div>
        <button class="close-download-notification" id="closeDownloadNotification">
            <i class="fas fa-times"></i>
        </button>
    </div>
    
    <!-- 移动端右侧边栏 -->
    <div class="mobile-sidebar" id="mobileSidebar">
        <div class="sidebar-header">
            <h3>番剧管理</h3>
            <button class="close-sidebar" id="closeSidebar">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- 番剧分组 -->
            <div class="sidebar-section">
                <h4><i class="fas fa-film"></i> 番剧</h4>
                
                <div class="sidebar-search-container">
                    <i class="fas fa-search sidebar-search-icon"></i>
                    <input type="text" class="sidebar-search" id="mobileSearchInput" placeholder="搜索番剧名称...">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <p style="margin-bottom: 10px; color: #4cc9f0; font-weight: 500;">类型筛选</p>
                    <div class="sidebar-filter-buttons">
                        <button class="sidebar-filter-btn active" data-filter="all">全部</button>
                        <button class="sidebar-filter-btn" data-filter="normal">表番</button>
                        <button class="sidebar-filter-btn" data-filter="hentai">里番</button>
                        <button class="sidebar-filter-btn" data-filter="short">泡面番</button>
                    </div>
                </div>
                
                <div>
                    <p style="margin-bottom: 10px; color: #4cc9f0; font-weight: 500;">内容修改</p>
                    <div class="sidebar-filter-buttons">
                        <button class="sidebar-filter-btn mod-btn active" data-mod="all">全部</button>
                        <button class="sidebar-filter-btn mod-btn" data-mod="uncensored">无修正</button>
                        <button class="sidebar-filter-btn mod-btn" data-mod="uncoded">无码</button>
                        <button class="sidebar-filter-btn mod-btn" data-mod="coded">有码</button>
                    </div>
                </div>
            </div>
            
            <!-- 设置分组 -->
            <div class="sidebar-section">
                <h4><i class="fas fa-cog"></i> 设置</h4>
                
                <div style="margin-bottom: 15px;">
                    <p style="margin-bottom: 10px; color: #4cc9f0; font-weight: 500;">数据分组</p>
                    <button class="sidebar-btn" id="mobileAddBtn">
                        <i class="fas fa-plus-circle"></i> 添加新番剧
                    </button>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <p style="margin-bottom: 10px; color: #4cc9f0; font-weight: 500;">主题设置</p>
                    <button class="sidebar-btn theme" id="mobileThemeBtn">
                        <i class="fas fa-moon"></i> 切换主题
                    </button>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <p style="margin-bottom: 10px; color: #4cc9f0; font-weight: 500;">数据导入/导出</p>
                    <button class="sidebar-btn upload" id="mobileUploadBtn">
                        <i class="fas fa-file-import"></i> 导入JSON数据
                    </button>
                    <input type="file" id="mobileFileInput" accept=".json" style="display: none;">
                    
                    <button class="sidebar-btn export" id="mobileExportBtn">
                        <i class="fas fa-file-export"></i> 导出JSON数据
                    </button>
                    
                    <button class="sidebar-btn clear" id="mobileClearBtn">
                        <i class="fas fa-trash-alt"></i> 清空所有数据
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 侧边栏遮罩 -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- 移动端底部导航 -->
    <div class="mobile-nav">
        <button class="mobile-nav-btn active" data-nav="home">
            <i class="fas fa-home"></i>
            <span>首页</span>
        </button>
        <button class="mobile-nav-btn" data-nav="list">
            <i class="fas fa-list"></i>
            <span>列表</span>
        </button>
        <button class="mobile-nav-btn" data-nav="details">
            <i class="fas fa-info-circle"></i>
            <span>详情</span>
        </button>
        <button class="mobile-nav-btn" data-nav="sidebar">
            <i class="fas fa-sliders-h"></i>
            <span>设置</span>
        </button>
    </div>
    
    <!-- 主内容区域 -->
    <div class="container">
        <header class="fade-in">
            <h1><i class="fas fa-book-open"></i> 番剧历史记录索引管理系统</h1>
            <p class="subtitle">高效管理您的动漫番剧收藏，支持JSON数据导入与导出</p>
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i> 切换主题
            </button>
        </header>
        
        <div class="main-content">
            <!-- 电脑端上传区域 -->
            <div class="upload-section fade-in delay-1">
                <div class="upload-area" id="dropArea">
                    <i class="fas fa-file-import"></i>
                    <h3>上传JSON文件</h3>
                    <p>拖放文件到此处或点击上传</p>
                    <button class="upload-btn" id="uploadBtn">选择文件</button>
                    <input type="file" id="fileInput" accept=".json" style="display: none;">
                </div>
                
                <div class="file-info">
                    <h4><i class="fas fa-info-circle"></i> 文件格式说明</h4>
                    <p>系统支持JSON格式文件(.json)，文件应包含以下字段：</p>
                    <p>id: 序号 | name: 番名 | type: 番剧类型 | modification: 内容修改 | image: 图片链接(可选)</p>
                    <p>JSON格式示例：<br>[{"id":1,"name":"番名","type":"类型","modification":"修改状态","image":"url"}]</p>
                    <p>提示：Excel文件可通过在线转换工具转换为JSON格式</p>
                </div>
                
                <button class="export-btn" id="exportBtn">
                    <i class="fas fa-file-export"></i> 导出JSON数据
                    <div class="export-progress">
                        <div class="export-progress-bar"></div>
                    </div>
                </button>
                
                <button class="clear-btn" id="clearBtn">
                    <i class="fas fa-trash-alt"></i> 清空所有数据
                </button>
            </div>
            
            <!-- 表格容器 -->
            <div class="table-container fade-in delay-2">
                <!-- 电脑端控制区域 -->
                <div class="controls">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="搜索番剧名称...">
                    </div>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">全部</button>
                        <button class="filter-btn" data-filter="normal">表番</button>
                        <button class="filter-btn" data-filter="hentai">里番</button>
                        <button class="filter-btn" data-filter="short">泡面番</button>
                        <button class="filter-btn" id="addBtn"><i class="fas fa-plus"></i> 添加数据</button>
                    </div>
                    
                    <div class="filter-group">
                        <div class="filter-group-title">内容修改筛选：</div>
                        <div class="filter-buttons">
                            <button class="filter-btn mod-btn active" data-mod="all">全部</button>
                            <button class="filter-btn mod-btn" data-mod="uncensored">无修正</button>
                            <button class="filter-btn mod-btn" data-mod="uncoded">无码</button>
                            <button class="filter-btn mod-btn" data-mod="coded">有码</button>
                        </div>
                    </div>
                </div>
                
                <!-- 编辑表单 -->
                <div id="editFormContainer" style="display: none;">
                    <div class="edit-form">
                        <div class="form-group">
                            <label for="editId">序号</label>
                            <input type="number" id="editId" placeholder="自动生成" disabled>
                        </div>
                        <div class="form-group">
                            <label for="editName">番名</label>
                            <input type="text" id="editName" placeholder="输入番名">
                        </div>
                        <div class="form-group">
                            <label for="editType">类型</label>
                            <select id="editType">
                                <option value="表番">表番</option>
                                <option value="里番">里番</option>
                                <option value="泡面番">泡面番</option>
                                <option value="里番、泡面番">里番、泡面番</option>
                                <option value="表番、泡面番">表番、泡面番</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editMod">内容修改</label>
                            <select id="editMod">
                                <option value="无修正">无修正</option>
                                <option value="无码">无码</option>
                                <option value="有码">有码</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editImage">图片链接</label>
                            <input type="text" id="editImage" placeholder="输入图片URL或上传本地图片">
                            <div class="image-upload-container">
                                <button type="button" class="image-upload-btn" id="imageUploadBtn">
                                    <i class="fas fa-upload"></i> 上传本地图片
                                </button>
                                <input type="file" id="localImageInput" accept="image/*" style="display: none;">
                                <div class="upload-status" id="uploadStatus"></div>
                                <img class="image-preview" id="imagePreview" src="" alt="图片预览">
                                <button type="button" class="remove-image-btn" id="removeImageBtn">
                                    <i class="fas fa-times"></i> 移除图片
                                </button>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button class="action-btn save-btn" id="saveBtn"><i class="fas fa-save"></i> 保存</button>
                            <button class="action-btn cancel-btn" id="cancelBtn"><i class="fas fa-times"></i> 取消</button>
                        </div>
                    </div>
                </div>
                
                <!-- 表格包装器，用于横向滚动 -->
                <div class="data-table-wrapper">
                    <!-- 表格 -->
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>序号</th>
                                <th>番名</th>
                                <th>类型</th>
                                <th>内容修改</th>
                                <th>图片</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- 数据将通过JavaScript动态填充 -->
                        </tbody>
                    </table>
                </div>
                
                <!-- 分页 -->
                <div class="pagination" id="pagination">
                    <!-- 分页按钮将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
        
        <!-- 详情区域 -->
        <div class="detail-section fade-in delay-3">
            <div class="detail-header">
                <div class="detail-img">
                    <i class="fas fa-image"></i>
                    <span>番剧封面</span>
                </div>
                <div class="detail-info">
                    <h2>选择番剧查看详情</h2>
                    <p>类型: <span>--</span></p>
                    <p>内容修改: <span>--</span></p>
                    <p>序号: <span>--</span></p>
                </div>
            </div>
            <div class="detail-content">
                <p>在左侧表格中选择一个番剧项目，详细信息将显示在此处。</p>
            </div>
        </div>
        
        <!-- 统计区域 -->
        <div class="stats fade-in delay-4">
            <div class="stat-item">
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">番剧总数</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="normalCount">0</div>
                <div class="stat-label">表番数量</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="hentaiCount">0</div>
                <div class="stat-label">里番数量</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="uncensoredCount">0</div>
                <div class="stat-label">无码/无修正</div>
            </div>
        </div>
        
        <!-- 页脚 -->
        <footer class="fade-in delay-5">
            <p>© 2025 番剧历史记录索引管理系统 | 设计：前端工程师 | 数据仅用于展示</p>
        </footer>
    </div>
    
    <!-- 通知 -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i> 操作成功！
    </div>

    <!-- 确认对话框 -->
    <div class="confirmation-dialog" id="confirmationDialog">
        <div class="dialog-content">
            <div class="dialog-header">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>确认操作</h3>
            </div>
            <div class="dialog-body" id="dialogMessage">
                <!-- 消息内容将通过JavaScript填充 -->
            </div>
            <div class="dialog-footer">
                <button class="dialog-btn dialog-cancel" id="dialogCancel">取消</button>
                <button class="dialog-btn dialog-confirm" id="dialogConfirm">确认</button>
            </div>
        </div>
    </div>

    <script>
        // 初始化空数据
        let allData = [];
        
        let currentPage = 1;
        const rowsPerPage = 10;
        let currentFilter = "all";
        let currentModFilter = "all";
        let currentSearch = "";
        let selectedRow = null;
        let editingId = null;
        let importedFileName = "";
        
        // DOM元素
        const tableBody = document.getElementById('tableBody');
        const pagination = document.getElementById('pagination');
        const searchInput = document.getElementById('searchInput');
        const filterButtons = document.querySelectorAll('.filter-btn');
        const modButtons = document.querySelectorAll('.mod-btn');
        const fileInput = document.getElementById('fileInput');
        const uploadBtn = document.getElementById('uploadBtn');
        const dropArea = document.getElementById('dropArea');
        const totalCount = document.getElementById('totalCount');
        const normalCount = document.getElementById('normalCount');
        const hentaiCount = document.getElementById('hentaiCount');
        const uncensoredCount = document.getElementById('uncensoredCount');
        const notification = document.getElementById('notification');
        const addBtn = document.getElementById('addBtn');
        const editFormContainer = document.getElementById('editFormContainer');
        const editId = document.getElementById('editId');
        const editName = document.getElementById('editName');
        const editType = document.getElementById('editType');
        const editMod = document.getElementById('editMod');
        const editImage = document.getElementById('editImage');
        const saveBtn = document.getElementById('saveBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const exportBtn = document.getElementById('exportBtn');
        const clearBtn = document.getElementById('clearBtn');
        const confirmationDialog = document.getElementById('confirmationDialog');
        const dialogMessage = document.getElementById('dialogMessage');
        const dialogCancel = document.getElementById('dialogCancel');
        const dialogConfirm = document.getElementById('dialogConfirm');
        const exportProgressBar = document.querySelector('.export-progress-bar');
        const themeToggle = document.getElementById('themeToggle');
        
        // 图片上传相关元素
        const imageUploadBtn = document.getElementById('imageUploadBtn');
        const localImageInput = document.getElementById('localImageInput');
        const imagePreview = document.getElementById('imagePreview');
        const removeImageBtn = document.getElementById('removeImageBtn');
        const uploadStatus = document.getElementById('uploadStatus');
        
        // 移动端元素
        const mobileSidebar = document.getElementById('mobileSidebar');
        const closeSidebar = document.getElementById('closeSidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const mobileSearchInput = document.getElementById('mobileSearchInput');
        const mobileFilterButtons = document.querySelectorAll('.sidebar-filter-btn');
        const mobileAddBtn = document.getElementById('mobileAddBtn');
        const mobileThemeBtn = document.getElementById('mobileThemeBtn');
        const mobileUploadBtn = document.getElementById('mobileUploadBtn');
        const mobileExportBtn = document.getElementById('mobileExportBtn');
        const mobileClearBtn = document.getElementById('mobileClearBtn');
        const mobileFileInput = document.getElementById('mobileFileInput');
        const mobileNavBtns = document.querySelectorAll('.mobile-nav-btn');
        
        // 修改：下载提示元素
        const downloadNotification = document.getElementById('downloadNotification');
        const closeDownloadNotification = document.getElementById('closeDownloadNotification');
        
        // 显示下载提示（修改为居中显示）
        function showDownloadNotification() {
            // 确保没有其他弹窗干扰
            confirmationDialog.classList.remove('show');
            
            // 显示下载提示
            downloadNotification.classList.add('show');
            
            // 5秒后自动关闭
            setTimeout(() => {
                downloadNotification.classList.remove('show');
            }, 5000);
        }
        
        // 关闭下载提示
        function closeDownloadNotificationHandler() {
            downloadNotification.classList.remove('show');
        }
        
        // 初始化表格
        function renderTable() {
            // 应用筛选和搜索
            let filteredData = allData;
            
            // 类型筛选
            if (currentFilter !== "all") {
                filteredData = filteredData.filter(item => {
                    if (currentFilter === "normal") return item.type.includes("表番");
                    if (currentFilter === "hentai") return item.type.includes("里番");
                    if (currentFilter === "short") return item.type.includes("泡面番");
                    return true;
                });
            }
            
            // 内容修改筛选
            if (currentModFilter !== "all") {
                filteredData = filteredData.filter(item => {
                    if (currentModFilter === "uncensored") return item.modification === "无修正";
                    if (currentModFilter === "uncoded") return item.modification === "无码";
                    if (currentModFilter === "coded") return item.modification === "有码";
                    return true;
                });
            }
            
            // 搜索筛选
            if (currentSearch) {
                const searchTerm = currentSearch.toLowerCase();
                filteredData = filteredData.filter(item => 
                    item.name.toLowerCase().includes(searchTerm) || 
                    String(item.id).includes(searchTerm)
                );
            }
            
            // 更新统计信息
            updateStats(filteredData);
            
            // 分页
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            const startIndex = (currentPage - 1) * rowsPerPage;
            const endIndex = Math.min(startIndex + rowsPerPage, filteredData.length);
            const pageData = filteredData.slice(startIndex, endIndex);
            
            // 清空表格
            tableBody.innerHTML = '';
            
            // 如果数据为空，显示空状态
            if (pageData.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `
                    <td colspan="6">
                        <div class="empty-state">
                            <i class="fas fa-database"></i>
                            <h3>数据库为空</h3>
                            <p>请上传JSON文件添加数据，或点击"添加数据"按钮</p>
                        </div>
                    </td>
                `;
                tableBody.appendChild(emptyRow);
                
                // 清空分页
                pagination.innerHTML = '';
                
                // 清空详情
                showDetails(null);
                return;
            }
            
            // 填充表格
            pageData.forEach(item => {
                const row = document.createElement('tr');
                
                // 类型标签
                let typeClass = "type-normal";
                if (item.type.includes("里番")) typeClass = "type-hentai";
                if (item.type.includes("泡面番")) typeClass = "type-short";
                
                // 内容修改标签
                let modClass = "uncensored";
                let modText = item.modification;
                if (item.modification.includes("有码")) {
                    modClass = "censored";
                }
                
                // 为行添加类型类
                row.classList.add(typeClass.replace('type-', ''));
                
                row.innerHTML = `
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td><span class="type-tag ${typeClass}">${item.type}</span></td>
                    <td><span class="content-mod ${modClass}">${modText}</span></td>
                    <td>
                        <div class="thumbnail">
                            ${item.image ? 
                                `<img src="${item.image}" alt="${item.name}">` : 
                                `<i class="fas fa-image"></i><span>无图片</span>`}
                        </div>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="edit-btn" data-id="${item.id}"><i class="fas fa-edit"></i></button>
                            <button class="delete-btn" data-id="${item.id}"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                    <div class="selected-indicator"></div>
                `;
                
                // 添加点击事件显示详情
                row.addEventListener('click', (e) => {
                    if(e.target.closest('.edit-btn') || e.target.closest('.delete-btn')) return;
                    
                    // 移除之前选中的行
                    if (selectedRow) {
                        selectedRow.classList.remove('selected-row');
                    }
                    
                    // 设置当前行为选中状态
                    row.classList.add('selected-row');
                    selectedRow = row;
                    
                    // 显示详情
                    showDetails(item);
                });
                
                // 编辑按钮事件
                const editBtn = row.querySelector('.edit-btn');
                editBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const id = editBtn.dataset.id;
                    const item = allData.find(i => i.id == id);
                    openEditForm(item);
                });
                
                // 删除按钮事件
                const deleteBtn = row.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const id = deleteBtn.dataset.id;
                    showConfirmation(`确定要删除番剧 "${item.name}" 吗？`, () => {
                        deleteItem(id);
                    });
                });
                
                tableBody.appendChild(row);
            });
            
            // 渲染分页
            renderPagination(totalPages);
        }
        
        // 渲染分页控件（增强版）
        function renderPagination(totalPages) {
            pagination.innerHTML = '';
            
            if (totalPages === 0) {
                return;
            }
            
            // 最前按钮
            const firstBtn = document.createElement('div');
            firstBtn.className = 'page-btn';
            firstBtn.innerHTML = '<i class="fas fa-step-backward"></i>';
            firstBtn.title = '第一页';
            firstBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage = 1;
                    renderTable();
                }
            });
            pagination.appendChild(firstBtn);
            
            // 上一页按钮
            const prevBtn = document.createElement('div');
            prevBtn.className = 'page-btn';
            prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
            prevBtn.title = '上一页';
            prevBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderTable();
                }
            });
            pagination.appendChild(prevBtn);
            
            // 页码文本
            const pageText = document.createElement('div');
            pageText.className = 'page-text';
            pageText.textContent = `第 ${currentPage} / ${totalPages} 页`;
            pagination.appendChild(pageText);
            
            // 页码输入框
            const pageInput = document.createElement('input');
            pageInput.type = 'number';
            pageInput.className = 'page-input';
            pageInput.min = 1;
            pageInput.max = totalPages;
            pageInput.value = currentPage;
            pageInput.title = '输入页码跳转';
            pageInput.addEventListener('change', () => {
                let pageNum = parseInt(pageInput.value);
                if (pageNum < 1) pageNum = 1;
                if (pageNum > totalPages) pageNum = totalPages;
                
                if (pageNum !== currentPage) {
                    currentPage = pageNum;
                    renderTable();
                }
            });
            pagination.appendChild(pageInput);
            
            // 跳转按钮
            const goBtn = document.createElement('div');
            goBtn.className = 'page-btn';
            goBtn.textContent = '跳转';
            goBtn.title = '跳转到指定页码';
            goBtn.addEventListener('click', () => {
                let pageNum = parseInt(pageInput.value);
                if (pageNum < 1) pageNum = 1;
                if (pageNum > totalPages) pageNum = totalPages;
                
                if (pageNum !== currentPage) {
                    currentPage = pageNum;
                    renderTable();
                }
            });
            pagination.appendChild(goBtn);
            
            // 下一页按钮
            const nextBtn = document.createElement('div');
            nextBtn.className = 'page-btn';
            nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
            nextBtn.title = '下一页';
            nextBtn.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderTable();
                }
            });
            pagination.appendChild(nextBtn);
            
            // 最后按钮
            const lastBtn = document.createElement('div');
            lastBtn.className = 'page-btn';
            lastBtn.innerHTML = '<i class="fas fa-step-forward"></i>';
            lastBtn.title = '最后一页';
            lastBtn.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage = totalPages;
                    renderTable();
                }
            });
            pagination.appendChild(lastBtn);
        }
        
        // 显示详情
        function showDetails(item) {
            const detailImg = document.querySelector('.detail-img');
            const detailInfo = document.querySelector('.detail-info');
            const detailContent = document.querySelector('.detail-content');
            
            if (!item) {
                detailImg.innerHTML = `<i class="fas fa-image"></i><span>番剧封面</span>`;
                detailInfo.innerHTML = `
                    <h2>选择番剧查看详情</h2>
                    <p>类型: <span>--</span></p>
                    <p>内容修改: <span>--</span></p>
                    <p>序号: <span>--</span></p>
                `;
                detailContent.innerHTML = `<p>在左侧表格中选择一个番剧项目，详细信息将显示在此处。</p>`;
                return;
            }
            
            // 更新图片
            if (item.image) {
                detailImg.innerHTML = `<img src="${item.image}" alt="${item.name}">`;
            } else {
                detailImg.innerHTML = `<i class="fas fa-image"></i><span>番剧封面</span>`;
            }
            
            // 更新信息
            detailInfo.innerHTML = `
                <h2>${item.name}</h2>
                <p>类型: <span>${item.type}</span></p>
                <p>内容修改: <span>${item.modification}</span></p>
                <p>序号: <span>${item.id}</span></p>
            `;
            
            // 更新内容
            detailContent.innerHTML = `
                <p>${item.name} 是一部${item.type.includes('里番') ? '成人向' : '一般向'}的动漫作品。</p>
                <p>当前版本内容修改状态为: <strong>${item.modification}</strong>。</p>
                <p>该作品已被收录在番剧历史记录索引中，编号为${item.id}。</p>
            `;
        }
        
        // 更新统计信息
        function updateStats(data) {
            totalCount.textContent = allData.length;
            
            const normal = allData.filter(item => item.type.includes("表番")).length;
            const hentai = allData.filter(item => item.type.includes("里番")).length;
            const uncensored = allData.filter(item => 
                item.modification.includes("无修正") || item.modification.includes("无码")).length;
            
            normalCount.textContent = normal;
            hentaiCount.textContent = hentai;
            uncensoredCount.textContent = uncensored;
        }
        
        // 显示通知
        function showNotification(message, isSuccess = true) {
            notification.innerHTML = `<i class="fas ${isSuccess ? 'fa-check-circle' : 'fa-exclamation-triangle'}"></i> ${message}`;
            notification.style.background = isSuccess ? 'rgba(46, 204, 113, 0.9)' : 'rgba(231, 76, 60, 0.9)';
            notification.className = isSuccess ? 'notification show' : 'notification show error';
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // 打开编辑表单
        function openEditForm(item = null) {
            editFormContainer.style.display = 'block';
            
            // 重置图片上传区域
            resetImageUpload();
            
            if (item) {
                // 编辑现有项目
                editingId = item.id;
                editId.value = item.id;
                editName.value = item.name;
                editType.value = item.type;
                editMod.value = item.modification;
                editImage.value = item.image || '';
                
                // 如果有图片，显示预览
                if (item.image) {
                    if (item.image.startsWith('data:image')) {
                        // 如果是base64图片，直接显示预览
                        imagePreview.src = item.image;
                        imagePreview.style.display = 'block';
                        removeImageBtn.style.display = 'block';
                    } else {
                        // 如果是URL，显示在输入框中
                        editImage.value = item.image;
                    }
                }
            } else {
                // 添加新项目
                editingId = null;
                const maxId = allData.length > 0 ? Math.max(...allData.map(i => i.id)) : 0;
                editId.value = maxId + 1;
                editName.value = '';
                editType.value = '表番';
                editMod.value = '无修正';
                editImage.value = '';
            }
            
            // 滚动到表单位置
            document.querySelector('.table-container').scrollTop = 0;
            
            // 移动端关闭侧边栏
            closeMobileSidebar();
        }
        
        // 重置图片上传区域
        function resetImageUpload() {
            imagePreview.src = '';
            imagePreview.style.display = 'none';
            removeImageBtn.style.display = 'none';
            uploadStatus.textContent = '';
            editImage.value = '';
            
            // 修复问题：重置文件输入元素的值
            localImageInput.value = '';
        }
        
        // 保存表单数据
        function saveForm() {
            const id = parseInt(editId.value);
            const name = editName.value.trim();
            const type = editType.value;
            const modification = editMod.value;
            
            // 优先使用上传的图片，如果没有则使用输入的URL
            let image = editImage.value.trim();
            if (imagePreview.style.display === 'block') {
                image = imagePreview.src;
            }
            
            if (!name) {
                showNotification("番名不能为空！", false);
                return;
            }
            
            // 保存当前页码
            const prevPage = currentPage;
            
            if (editingId !== null) {
                // 更新现有项目
                const index = allData.findIndex(item => item.id === editingId);
                if (index !== -1) {
                    allData[index] = { id, name, type, modification, image };
                }
                showNotification("番剧信息更新成功！");
            } else {
                // 添加新项目
                // 检查ID是否已存在
                if (allData.some(item => item.id === id)) {
                    showNotification("序号已存在，请使用不同的序号", false);
                    return;
                }
                
                allData.push({ id, name, type, modification, image });
                showNotification("番剧添加成功！");
            }
            
            // 关闭表单
            editFormContainer.style.display = 'none';
            
            // 恢复之前的页码
            currentPage = prevPage;
            renderTable();
        }
        
        // 删除项目
        function deleteItem(id) {
            // 删除项目
            allData = allData.filter(item => item.id != id);
            
            // 重新排序所有剩余项目的序号
            allData.forEach((item, index) => {
                item.id = index + 1;
            });
            
            showNotification("番剧删除成功！");
            currentPage = 1;
            renderTable();
        }
        
        // 导出为JSON文件
        function exportToJson() {
            if (allData.length === 0) {
                showNotification("没有数据可导出", false);
                return;
            }
            
            try {
                // 显示导出进度
                exportBtn.classList.add('exporting');
                exportProgressBar.style.width = '0%';
                
                // 模拟导出进度
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 5;
                    exportProgressBar.style.width = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        
                        // 导出文件
                        const jsonData = JSON.stringify(allData, null, 2);
                        const blob = new Blob([jsonData], { type: 'application/json' });
                        const url = URL.createObjectURL(blob);
                        
                        const a = document.createElement('a');
                        a.href = url;
                        
                        // 使用导入的文件名（如果存在），否则使用默认文件名
                        let fileName = 'bangumi_data';
                        if (importedFileName) {
                            fileName = importedFileName.replace('.json', '') + '_export';
                        } else {
                            fileName = `bangumi_data_${new Date().toISOString().slice(0, 10)}`;
                        }
                        
                        a.download = `${fileName}.json`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                        
                        showNotification("数据导出成功！");
                        
                        // 在所有设备上都显示下载提示（居中弹出）
                        showDownloadNotification();
                        
                        // 重置导出按钮
                        setTimeout(() => {
                            exportBtn.classList.remove('exporting');
                        }, 500);
                        
                        // 移动端关闭侧边栏
                        closeMobileSidebar();
                    }
                }, 50);
            } catch (error) {
                showNotification(`导出失败: ${error.message}`, false);
                exportBtn.classList.remove('exporting');
            }
        }
        
        // 清空数据
        function clearAllData() {
            allData = [];
            importedFileName = ""; // 清空文件名
            currentPage = 1;
            selectedRow = null;
            showDetails(null);
            renderTable();
            showNotification("所有数据已清空！");
            
            // 移动端关闭侧边栏
            closeMobileSidebar();
        }
        
        // 显示确认对话框
        function showConfirmation(message, confirmCallback) {
            dialogMessage.innerHTML = message;
            confirmationDialog.classList.add('show');
            
            const confirmHandler = () => {
                confirmationDialog.classList.remove('show');
                confirmCallback();
                dialogConfirm.removeEventListener('click', confirmHandler);
            };
            
            const cancelHandler = () => {
                confirmationDialog.classList.remove('show');
                dialogCancel.removeEventListener('click', cancelHandler);
            };
            
            dialogConfirm.addEventListener('click', confirmHandler);
            dialogCancel.addEventListener('click', cancelHandler);
        }
        
        // 处理文件上传
        function handleFileUpload(file) {
            if (file.type === "application/json" || file.name.endsWith('.json')) {
                // 显示加载状态
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6">
                            <div class="loader">
                                <div class="loader-spinner"></div>
                            </div>
                        </td>
                    </tr>
                `;
                
                // 存储文件名（不含扩展名）
                importedFileName = file.name.replace('.json', '');
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const jsonData = JSON.parse(e.target.result);
                        if (Array.isArray(jsonData)) {
                            allData = jsonData;
                            showNotification("JSON文件导入成功！");
                            currentPage = 1;
                            renderTable();
                        } else {
                            showNotification("JSON格式错误：应为数组", false);
                            renderTable();
                        }
                    } catch (error) {
                        showNotification("JSON解析错误：" + error.message, false);
                        renderTable();
                    }
                };
                
                reader.onerror = function() {
                    showNotification("文件读取失败", false);
                    renderTable();
                };
                
                reader.readAsText(file);
            } else {
                showNotification("请上传JSON格式文件", false);
            }
            
            // 移动端关闭侧边栏
            closeMobileSidebar();
        }
        
        // 处理图片上传
        function handleImageUpload(file) {
            if (!file.type.match('image.*')) {
                showNotification("请选择图片文件", false);
                return;
            }
            
            // 检查文件大小（限制为2MB）
            if (file.size > 2 * 1024 * 1024) {
                showNotification("图片大小不能超过2MB", false);
                return;
            }
            
            uploadStatus.textContent = '上传中...';
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                // 将图片转换为base64
                const base64 = e.target.result;
                
                // 显示预览
                imagePreview.src = base64;
                imagePreview.style.display = 'block';
                removeImageBtn.style.display = 'block';
                
                // 清空URL输入框
                editImage.value = '';
                
                uploadStatus.textContent = '上传成功！';
                
                setTimeout(() => {
                    uploadStatus.textContent = '';
                }, 2000);
            };
            
            reader.onerror = function() {
                uploadStatus.textContent = '上传失败';
                showNotification("图片上传失败", false);
            };
            
            reader.readAsDataURL(file);
        }
        
        // 切换移动端侧边栏
        function toggleMobileSidebar() {
            mobileSidebar.classList.toggle('open');
            sidebarOverlay.classList.toggle('show');
        }
        
        // 关闭移动端侧边栏
        function closeMobileSidebar() {
            mobileSidebar.classList.remove('open');
            sidebarOverlay.classList.remove('show');
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            renderTable();
            updateStats(allData);
            
            // 添加一些动画延迟效果
            document.querySelectorAll('.fade-in').forEach((el, index) => {
                el.style.animationDelay = `${index * 0.1}s`;
            });
            
            // 检查本地存储的主题设置
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> 切换主题';
                mobileThemeBtn.innerHTML = '<i class="fas fa-sun"></i> 切换主题';
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i> 切换主题';
                mobileThemeBtn.innerHTML = '<i class="fas fa-moon"></i> 切换主题';
                localStorage.setItem('theme', 'light');
            }
            
            // 检测字体图标是否加载
            setTimeout(function() {
                const testIcon = document.createElement('i');
                testIcon.className = 'fas fa-check';
                testIcon.style.visibility = 'hidden';
                document.body.appendChild(testIcon);
                
                // 检查图标是否已应用样式
                const computedStyle = window.getComputedStyle(testIcon);
                const fontFamily = computedStyle.fontFamily;
                
                if (!fontFamily.includes('Font Awesome')) {
                    console.warn('本地字体图标库未加载，确保css/all.min.css文件存在');
                }
                
                document.body.removeChild(testIcon);
            }, 1000);
            
            // 修改：绑定下载提示关闭事件
            closeDownloadNotification.addEventListener('click', closeDownloadNotificationHandler);
        });
        
        // ========== 移动端功能 ==========
        
        // 打开/关闭移动端侧边栏
        closeSidebar.addEventListener('click', closeMobileSidebar);
        sidebarOverlay.addEventListener('click', closeMobileSidebar);
        
        // 移动端搜索
        mobileSearchInput.addEventListener('input', () => {
            currentSearch = mobileSearchInput.value;
            currentPage = 1;
            renderTable();
        });
        
        // 移动端筛选
        mobileFilterButtons.forEach(button => {
            button.addEventListener('click', () => {
                if (button.classList.contains('mod-btn')) {
                    // 内容修改筛选
                    document.querySelectorAll('.sidebar-filter-btn.mod-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    button.classList.add('active');
                    currentModFilter = button.dataset.mod;
                } else {
                    // 类型筛选
                    document.querySelectorAll('.sidebar-filter-btn:not(.mod-btn)').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    button.classList.add('active');
                    currentFilter = button.dataset.filter;
                }
                
                currentPage = 1;
                renderTable();
            });
        });
        
        // 移动端添加数据
        mobileAddBtn.addEventListener('click', () => {
            openEditForm();
        });
        
        // 移动端主题切换
        mobileThemeBtn.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            const isDarkTheme = document.body.classList.contains('dark-theme');
            
            if (isDarkTheme) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> 切换主题';
                mobileThemeBtn.innerHTML = '<i class="fas fa-sun"></i> 切换主题';
                localStorage.setItem('theme', 'dark');
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i> 切换主题';
                mobileThemeBtn.innerHTML = '<i class="fas fa-moon"></i> 切换主题';
                localStorage.setItem('theme', 'light');
            }
            
            closeMobileSidebar();
        });
        
        // 移动端上传文件
        mobileUploadBtn.addEventListener('click', () => {
            mobileFileInput.click();
        });
        
        mobileFileInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                handleFileUpload(e.target.files[0]);
            }
        });
        
        // 移动端导出数据
        mobileExportBtn.addEventListener('click', exportToJson);
        
        // 移动端清空数据
        mobileClearBtn.addEventListener('click', () => {
            showConfirmation("确定要清空所有数据吗？此操作不可撤销！", clearAllData);
        });
        
        // 移动端底部导航
        mobileNavBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // 更新导航按钮状态
                mobileNavBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const navAction = btn.dataset.nav;
                
                // 根据导航项执行不同操作
                switch(navAction) {
                    case 'home':
                        // 滚动到顶部
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        break;
                    case 'list':
                        // 滚动到表格区域
                        document.querySelector('.table-container').scrollIntoView({ behavior: 'smooth' });
                        break;
                    case 'details':
                        // 滚动到详情区域
                        document.querySelector('.detail-section').scrollIntoView({ behavior: 'smooth' });
                        break;
                    case 'sidebar':
                        // 打开侧边栏
                        toggleMobileSidebar();
                        break;
                }
            });
        });
        
        // ========== 电脑端功能 ==========
        
        // 文件上传处理
        uploadBtn.addEventListener('click', () => {
            // 修复问题：重置文件输入元素的值
            fileInput.value = '';
            fileInput.click();
        });
        
        fileInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                handleFileUpload(e.target.files[0]);
            }
        });
        
        // 图片上传处理
        imageUploadBtn.addEventListener('click', () => {
            // 修复问题：重置文件输入元素的值
            localImageInput.value = '';
            localImageInput.click();
        });
        
        localImageInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                handleImageUpload(e.target.files[0]);
            }
        });
        
        // 移除图片按钮
        removeImageBtn.addEventListener('click', () => {
            resetImageUpload();
        });
        
        // 拖放功能
        dropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropArea.style.borderColor = '#4361ee';
            dropArea.style.backgroundColor = 'rgba(230, 233, 238, 0.8)';
        });
        
        dropArea.addEventListener('dragleave', () => {
            dropArea.style.borderColor = '#4361ee';
            dropArea.style.backgroundColor = 'rgba(245, 247, 250, 0.7)';
        });
        
        dropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            dropArea.style.borderColor = '#4361ee';
            dropArea.style.backgroundColor = 'rgba(245, 247, 250, 0.7)';
            
            if (e.dataTransfer.files.length) {
                handleFileUpload(e.dataTransfer.files[0]);
            }
        });
        
        // 搜索功能
        searchInput.addEventListener('input', () => {
            currentSearch = searchInput.value;
            currentPage = 1;
            renderTable();
        });
        
        // 类型筛选功能
        filterButtons.forEach(button => {
            button.addEventListener('click', () => {
                if (button.id === 'addBtn') return;
                if (button.classList.contains('mod-btn')) return;
                
                filterButtons.forEach(btn => {
                    if (btn.id !== 'addBtn' && !btn.classList.contains('mod-btn')) {
                        btn.classList.remove('active');
                    }
                });
                button.classList.add('active');
                
                currentFilter = button.dataset.filter;
                currentPage = 1;
                renderTable();
            });
        });
        
        // 内容修改筛选功能
        modButtons.forEach(button => {
            button.addEventListener('click', () => {
                modButtons.forEach(btn => {
                    btn.classList.remove('active');
                });
                button.classList.add('active');
                
                currentModFilter = button.dataset.mod;
                currentPage = 1;
                renderTable();
            });
        });
        
        // 添加数据按钮
        addBtn.addEventListener('click', () => {
            openEditForm();
        });
        
        // 保存按钮
        saveBtn.addEventListener('click', saveForm);
        
        // 取消按钮
        cancelBtn.addEventListener('click', () => {
            editFormContainer.style.display = 'none';
        });
        
        // 导出按钮
        exportBtn.addEventListener('click', exportToJson);
        
        // 清空数据按钮
        clearBtn.addEventListener('click', () => {
            showConfirmation("确定要清空所有数据吗？此操作不可撤销！", clearAllData);
        });
        
        // 主题切换功能
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            const isDarkTheme = document.body.classList.contains('dark-theme');
            
            if (isDarkTheme) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> 切换主题';
                mobileThemeBtn.innerHTML = '<i class="fas fa-sun"></i> 切换主题';
                localStorage.setItem('theme', 'dark');
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i> 切换主题';
                mobileThemeBtn.innerHTML = '<i class="fas fa-moon"></i> 切换主题';
                localStorage.setItem('theme', 'light');
            }
        });
    </script>
</body>
</html>